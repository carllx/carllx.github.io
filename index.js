!function(){"use strict";function e(){c=new THREE.Scene,c.fog=new THREE.Fog(k[1],0,T-300),w=new THREE.AmbientLight(k[0],1.8),c.add(w),m=new THREE.SpotLight(k[1]),m.position.set(0,100,20),m.target.position.set(0,0,0),m.angle=Math.PI/180*20,m.intensity=2,m.distance=200,m.penumbra=.9,m.decay=1.5,m.castShadow=!0,m.shadow=new THREE.LightShadow(new THREE.PerspectiveCamera(28,1,1,200)),m.shadow.bias=.001,m.shadow.mapSize.width=256,m.shadow.mapSize.height=256,c.add(m),f=new THREE.PerspectiveCamera(35,R/x,y,T),f.position.z=100,l=new THREE.DeviceOrientationControls(f),g=new H({size:300,pixel:[50,60],color:k[0]}),b=new H({size:300,pixel:[50,60],color:k[0]}),v=new H({size:20,pixel:[6,6],mat_side:THREE.DoubleSide}),g.getMesh(),b.getMesh(),v.getMesh(),g.makeNoice(8,[0,0,1]),b.makeNoice(8,[0,0,1]),g.rotate([Math.PI/2,0,0]),b.rotate([Math.PI/2,0,0]),v.rotate([Math.PI/2,0,Math.PI/4]),g.locate([0,M,0]),b.locate([0,M,-300]),v.locate([0,0,0]),c.add(g.mesh),c.add(b.mesh);var e={width:10,height:7,depth:7,widthSegments:6,heightSegments:3,depthSegments:3},t=new THREE.BoxGeometry(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments),o=new THREE.MeshStandardMaterial({color:k[0],shading:THREE.FlatShading});p=new THREE.Mesh(t,o);for(var a=[2,3,2],r=p.geometry.vertices,s=0;s<r.length;s++)r[s].x+=(-1+2*Math.random())*a[0],r[s].y+=(-1+2*Math.random())*a[1],r[s].z+=(-1+2*Math.random())*a[2];c.add(p),u.setClearColor(c.fog.color),u.shadowMap.enabled=!0,u.setPixelRatio(window.devicePixelRatio),u.setSize(window.innerWidth,window.innerHeight),document.getElementById("gl_container").appendChild(u.domElement),window.box=p,window.camera=f,window.scene=c,i(),window.addEventListener("resize",n,!1)}function t(){var e=10*E.getElapsedTime();if(l.update(),g.walk2cam(.2),b.walk2cam(.2),1!=device.wechat){for(var t=0;t<p.geometry.vertices.length;t++)p.geometry.vertices[t].y+=.01*Math.sin((e+t)/10),p.geometry.vertices[t].x+=.005*Math.sin((e+t)/7),p.geometry.vertices[t].z+=.08*Math.sin(e/13);p.geometry.verticesNeedUpdate=!0}}function i(){u.render(c,f),t(),requestAnimationFrame(i)}function n(){f.aspect=window.innerWidth/window.innerHeight,f.updateProjectionMatrix(),u.setSize(window.innerWidth,window.innerHeight)}var o="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),h=function(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)},d=function(e,t){return t={exports:{}},e(t,t.exports),t.exports}(function(e){(function(){var t,i,n,o,r,s,h,d,c,l;i=window.device,t={},window.device=t,o=window.document.documentElement,l=window.navigator.userAgent.toLowerCase(),t.ios=function(){return t.iphone()||t.ipod()||t.ipad()},t.iphone=function(){return!t.windows()&&r("iphone")},t.ipod=function(){return r("ipod")},t.ipad=function(){return r("ipad")},t.android=function(){return!t.windows()&&r("android")},t.androidPhone=function(){return t.android()&&r("mobile")},t.androidTablet=function(){return t.android()&&!r("mobile")},t.blackberry=function(){return r("blackberry")||r("bb10")||r("rim")},t.blackberryPhone=function(){return t.blackberry()&&!r("tablet")},t.blackberryTablet=function(){return t.blackberry()&&r("tablet")},t.windows=function(){return r("windows")},t.windowsPhone=function(){return t.windows()&&r("phone")},t.windowsTablet=function(){return t.windows()&&r("touch")&&!t.windowsPhone()},t.fxos=function(){return(r("(mobile;")||r("(tablet;"))&&r("; rv:")},t.fxosPhone=function(){return t.fxos()&&r("mobile")},t.fxosTablet=function(){return t.fxos()&&r("tablet")},t.meego=function(){return r("meego")},t.cordova=function(){return window.cordova&&"file:"===location.protocol},t.nodeWebkit=function(){return"object"===a(window.process)},t.mobile=function(){return t.androidPhone()||t.iphone()||t.ipod()||t.windowsPhone()||t.blackberryPhone()||t.fxosPhone()||t.meego()},t.tablet=function(){return t.ipad()||t.androidTablet()||t.blackberryTablet()||t.windowsTablet()||t.fxosTablet()},t.desktop=function(){return!t.tablet()&&!t.mobile()},t.television=function(){var e,t=["googletv","viera","smarttv","internet.tv","netcast","nettv","appletv","boxee","kylo","roku","dlnadoc","roku","pov_tv","hbbtv","ce-html"];for(e=0;e<t.length;){if(r(t[e]))return!0;e++}return!1},t.portrait=function(){return window.innerHeight/window.innerWidth>1},t.landscape=function(){return window.innerHeight/window.innerWidth<1},t.language=function(){return(navigator.browserLanguserAgentge||navigator.languserAgentge||navigator.language).toLowerCase()},t.cn=function(){return t.language()&&r("zh")},t.en=function(){return t.language()&&r("en")},t.it=function(){return t.language()&&r("it")},t.wechat=function(){return t.language()&&r("micromessenger")},t.wechatAndroid=function(){return t.wechat&&t.android()},t.noConflict=function(){return window.device=i,this},r=function(e){return l.indexOf(e)!==-1},h=function(e){var t;return t=new RegExp(e,"i"),o.className.match(t)},n=function(e){var t=null;h(e)||(t=o.className.replace(/^\s+|\s+$/g,""),o.className=t+" "+e)},c=function(e){h(e)&&(o.className=o.className.replace(" "+e,""))},t.ios()?t.ipad()?n("ios ipad tablet"):t.iphone()?n("ios iphone mobile"):t.ipod()&&n("ios ipod mobile"):t.android()?n(t.androidTablet()?"android tablet":"android mobile"):t.blackberry()?n(t.blackberryTablet()?"blackberry tablet":"blackberry mobile"):t.windows()?n(t.windowsTablet()?"windows tablet":t.windowsPhone()?"windows mobile":"desktop"):t.fxos()?n(t.fxosTablet()?"fxos tablet":"fxos mobile"):t.meego()?n("meego mobile"):t.nodeWebkit()?n("node-webkit"):t.television()?n("television"):t.desktop()&&n("desktop"),t.cordova()&&n("cordova"),s=function(){t.landscape()?(c("portrait"),n("landscape")):(c("landscape"),n("portrait"))},d=Object.prototype.hasOwnProperty.call(window,"onorientationchange")?"orientationchange":"resize",window.addEventListener?window.addEventListener(d,s,!1):window.attachEvent?window.attachEvent(d,s):window[d]=s,s(),e.exports?e.exports=t:window.device=t}).call(o)});THREE.DeviceOrientationControls=function(e){var t=this;this.object=e,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alpha=0,this.alphaOffsetAngle=0;var i=function(e){t.deviceOrientation=e},n=function(){t.screenOrientation=window.orientation||window.screen.orientation.angle||0},o=function(){var e=new THREE.Vector3(0,0,100),t=new THREE.Quaternion,i=new THREE.Vector3(0,0,1),n=new THREE.Euler,o=new THREE.Quaternion,a=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));return function(r,s,h,d,c){n.set(h,s,-d,"YXZ"),t.setFromEuler(n),t.multiply(a),t.multiply(o.setFromAxisAngle(i,-c));var l=new THREE.Matrix4,u=new THREE.Matrix4;l.setPosition(e),u.makeRotationFromQuaternion(t),u.multiply(l),r.matrix.copy(u),r.matrixAutoUpdate=!1}}();this.connect=function(){n(),window.addEventListener("orientationchange",n,!1),window.addEventListener("deviceorientation",i,!1),t.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",n,!1),window.removeEventListener("deviceorientation",i,!1),t.enabled=!1},this.update=function(){if(t.enabled!==!1){var e=t.deviceOrientation.alpha?THREE.Math.degToRad(t.deviceOrientation.alpha)+this.alphaOffsetAngle:0,i=t.deviceOrientation.beta?THREE.Math.degToRad(t.deviceOrientation.beta):0,n=t.deviceOrientation.gamma?THREE.Math.degToRad(t.deviceOrientation.gamma):0,a=t.screenOrientation?THREE.Math.degToRad(t.screenOrientation):0;o(t.object,e,i,n,a),t.object.matrixWorldNeedsUpdate=!0,this.alpha=e}},this.updateAlphaOffsetAngle=function(e){this.alphaOffsetAngle=e,this.update()},this.dispose=function(){this.disconnect()},this.connect()};var c=void 0,l=void 0,u=window.WebGLRenderingContext?new THREE.WebGLRenderer({antialias:!0}):new THREE.CanvasRenderer,w=void 0,m=void 0,f=void 0,p=void 0,g=void 0,v=void 0,b=void 0,E=new THREE.Clock,y=10,T=500,R=window.innerWidth,x=window.innerHeight,M=-20,k=[16776441,9626344,16738680,8833938,3753544],H=(function(){function e(t){r(this,e),this.mesh=t,this.size,this.Snapshots,this.frame=0,this.frameMax=10}s(e,[{key:"initMesh",value:function(e,t){for(var i=t[0],n=t[1],o=this.mesh.geometry.vertices,a=0;a<o.length;a++)o[a].x-=Math.random()*(i-n)+n,o[a].y-=Math.random()*(i-n)+n,o[a].z-=Math.random()*(i-n)+n;this.Snapshots=o,0==this.mesh.geometry.verticesNeedUpdate&&(this.mesh.geometry.verticesNeedUpdate=!0)}},{key:"generate",value:function(){}},{key:"animate",value:function(e){this.Snapshots[0]||(this.Snapshots=this.mesh.geometry.vertices);for(var t=0;t<this.animatCounters.length;t++)this.animatCounters+=.1;this.mesh.geometry.vertices}}]),e}(),function(){function e(t){r(this,e),this.size=t.size||200,this.pixel=t.pixel||[50,50],this.color=t.color||16776441,this.height=t.height||this.size,this.width=t.width||this.size,this.mat_side=t.mat_side||THREE.FrontSide,this.location,this.rotation,this.mesh}return s(e,[{key:"getMesh",value:function(){var e=new THREE.PlaneGeometry(this.size,this.size,this.pixel[0],this.pixel[1]),t=new THREE.MeshStandardMaterial({color:this.color,shading:THREE.FlatShading,side:this.mat_side}),i=new THREE.Mesh(e,t);return i.receiveShadow=!0,i.geometry.verticesNeedUpdate=!0,i.geometry.normalsNeedUpdate=!0,this.mesh=i,i}},{key:"makeNoice",value:function(e,t){for(var i=this.mesh.geometry.vertices,n=0;n<i.length;n++)1==t[0]&&(i[n].x+=(-1+2*Math.random())*e),1==t[1]&&(i[n].y+=(-1+2*Math.random())*e),1==t[2]&&(i[n].z+=(-1+2*Math.random())*e);this.mesh.geometry.verticesNeedUpdate=!0}},{key:"locate",value:function(e){var t;(t=this.mesh.position).set.apply(t,h(e)),this.location=this.mesh.position}},{key:"rotate",value:function(e){this.mesh.rotation.x=e[0],this.mesh.rotation.y=e[1],this.mesh.rotation.z=e[2],this.rotation=this.mesh.rotation}},{key:"walk2cam",value:function(e){this.mesh.position.z>=this.size-this.size/3?this.mesh.position.z=-this.location.z:this.mesh.position.z+=e}}]),e}());window.WebGLRenderingContext?new THREE.WebGLRenderer({antialias:!0}):new THREE.CanvasRenderer,new THREE.Clock,function(){function e(t){r(this,e),this.mesh=t,this.size,this.Snapshots,this.frame=0,this.frameMax=10}s(e,[{key:"initMesh",value:function(e,t){for(var i=t[0],n=t[1],o=this.mesh.geometry.vertices,a=0;a<o.length;a++)o[a].x-=Math.random()*(i-n)+n,o[a].y-=Math.random()*(i-n)+n,o[a].z-=Math.random()*(i-n)+n;this.Snapshots=o,0==this.mesh.geometry.verticesNeedUpdate&&(this.mesh.geometry.verticesNeedUpdate=!0)}},{key:"generate",value:function(){}},{key:"animate",value:function(e){this.Snapshots[0]||(this.Snapshots=this.mesh.geometry.vertices);for(var t=0;t<this.animatCounters.length;t++)this.animatCounters+=.1;this.mesh.geometry.vertices}}]),e}(),function(){function e(t){r(this,e),this.size=t.size||200,this.pixel=t.pixel||[50,50],this.color=t.color||16776441,this.height=t.height||this.size,this.width=t.width||this.size,this.mat_side=t.mat_side||THREE.FrontSide,this.location,this.rotation,this.mesh}s(e,[{key:"getMesh",value:function(){var e=new THREE.PlaneGeometry(this.size,this.size,this.pixel[0],this.pixel[1]),t=new THREE.MeshStandardMaterial({color:this.color,shading:THREE.FlatShading,side:this.mat_side}),i=new THREE.Mesh(e,t);return i.receiveShadow=!0,i.geometry.verticesNeedUpdate=!0,i.geometry.normalsNeedUpdate=!0,this.mesh=i,i}},{key:"makeNoice",value:function(e,t){for(var i=this.mesh.geometry.vertices,n=0;n<i.length;n++)1==t[0]&&(i[n].x+=(-1+2*Math.random())*e),1==t[1]&&(i[n].y+=(-1+2*Math.random())*e),1==t[2]&&(i[n].z+=(-1+2*Math.random())*e);this.mesh.geometry.verticesNeedUpdate=!0}},{key:"locate",value:function(e){var t;(t=this.mesh.position).set.apply(t,h(e)),this.location=this.mesh.position}},{key:"rotate",value:function(e){this.mesh.rotation.x=e[0],this.mesh.rotation.y=e[1],this.mesh.rotation.z=e[2],this.rotation=this.mesh.rotation}},{key:"walk2cam",value:function(e){this.mesh.position.z>=this.size-this.size/3?this.mesh.position.z=-this.location.z:this.mesh.position.z+=e}}]),e}();window.onload=function(){if(console.log("Device.default.wechat:",d.wechat()),1==d.wechat())return void console.log("Not Run THREE");e()}}();
